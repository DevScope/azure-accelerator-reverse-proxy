@model Microsoft.Samples.DPE.AzureMultiTenantApp.Web.Models.CertificateCreateModel

@{
    ViewBag.Title = "Upload Certificate";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Upload Certificate</h2>

<p>
    @Html.ActionLink("back to certificates list", "Index")
</p>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

<script type="text/javascript">
    function checkFileExtension() {
        if ($('#file').val() != '') {
            var ext = $('#file').val().split('.').pop().toLowerCase();
            if (ext != 'pfx') {
                alert('Only pfx certificates can be uploaded');
            }
        }
    }
</script>

@using (Html.BeginForm("Create", "Certificate", FormMethod.Post, new { enctype = "multipart/form-data" })) {
    @Html.ValidationSummary(true)
    
    <fieldset>
        <legend></legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Description)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.Description, new { style = "width: 600px; height: 100px;" })
            @Html.ValidationMessageFor(model => model.Description)
        </div>

        <div class="editor-label">
            Certificate File
        </div>
        <div class="editor-field">
            <input type="file" name="file" id="file" size="20" onchange="checkFileExtension()" style="width: 600px;"/>
            <span class="field-validation-valid error">
                @ViewBag.CertificateError
            </span>
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Password)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(model => model.Password)
            @Html.ValidationMessageFor(model => model.Password)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.ConfirmPassword)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(model => model.ConfirmPassword)
            @Html.ValidationMessageFor(model => model.ConfirmPassword)
        </div>
      <p>
            <input type="image" value="Upload" src="@Url.Content("~/Content/Create.png")" />
        </p>
    </fieldset>
}